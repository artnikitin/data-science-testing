# Построение отчета по продуктам и покупателям
Создание отчета по продуктам.
## Требования
### Формат данных
Отчет должен собирать информацию из двух датафреймов:

#### orders 
Cодержит информацию о заказах: идентификатор заказа, идентификатор покупателя, время заказа

```
OrderId,CustomerId,DateTime
5,583,2017-01-01 15:03:17
13,900,2019-02-05 05:02:59
69,19573,2018-11-03 23:59:59
```

#### order_lines 
Cодержит информацию о линиях чеков: идентификатор продукта, идентификатор заказа, цену продукта

```
ProductId,OrderId,Price
5873,5,3026.0
7265,5,573.0
9675,5,159.0
5873,6,2999.0
13,6,57.0
```
### Параметры отчета
В отчете должна содержаться следующая информация:

* Cамые популярные за последний месяц продукты
* Cуммарная выручка по каждому такому продукту
* Cредний чек заказов, в которых есть такие продукты

## Обзор проекта
Точка входа – файл ``summary_report.py``. Он забирает основную функцию, которая выдает отчет из файла `create_summary.py`, которая, в свою очередь, опирается на функции из файла `helpers.py`.
Функция выдает следующий отчет:


```
   ProductId  TotalRevenue  AverageCheck
0       8652  21212.549591   7070.849864
1       3083  20723.342060   6907.780687
2        615  16072.759135   5357.586378
3        526   8999.519248   4499.759624
4       4076  14749.578349   7374.789174
```
## Тесты
Тесты сделаны с помощью библиотеки `py.test` и находятся в файле `test_summary_report.py`.

## Зависимости
Для установки сторонних библиотек:

```
pip install -r requirements.txt
```

## SQL

### Описание задачи
В базе данных MS SQL Server есть продукты и категории. 
Одному продукту может соответствовать много категорий, в одной категории может быть много продуктов. 
Напишите SQL запрос для выбора всех пар «Имя продукта – Имя категории». 
Если у продукта нет категорий, то его имя все равно должно выводиться.

### Решение

Возьмем имеющиеся таблицы. Продуктом может быть ``ProductId`` в таблице `orders`, 
а категорией – `CustomerId` из таблицы `order_lines`.
Действительно, каждый продукт могут купить разные покупатели, 
как и один покупатель может приобрести разные продукты.

Код для вывода пар ``ProductId`` – `CustomerId` может выглядить следующим образом:

```
SELECT order_lines.ProductId, orders.CustomerId
FROM order_lines
LEFT JOIN orders
ON orders.OrderId = order_lines.OrderId;
```
Ответ будет содержать нужные пары и показывать названия продуктов, даже если
у них нет категорий.
```
ProductId CustomerId	
5873	583
7265	583
9675	583
5873    NULL	
13	NULL
```